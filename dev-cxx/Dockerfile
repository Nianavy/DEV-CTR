# ğŸ—ï¸ åŸºç¡€é•œåƒé€‰æ‹©ï¼šè½»é‡ä¸”å…¼å®¹æ€§å¼ºçš„ Ubuntu
FROM ubuntu

# ğŸš«ğŸ’¬ é¿å…å®‰è£…è¿‡ç¨‹ä¸­çš„äº¤äº’æç¤º
ENV DEBIAN_FRONTEND=noninteractive

############################################
# ğŸ“¦ å¼€å‘ç¯å¢ƒåŸºç¡€å¥—ä»¶å®‰è£…
############################################
RUN apt-get update && \
    apt-get install -y \
    build-essential \
    wget \
    gnupg \
    software-properties-common \
    cmake \
    ninja-build \
    git \
    gdb \
    clang-tidy \
    clang-format \
    pkg-config \
    glibc-doc \
    tcpdump \
    tshark \
    tmux \
    libreadline-dev \
    device-tree-compiler \
    && rm -rf /var/lib/apt/lists/*

############################################
# ğŸ”§ å®‰è£…æœ€æ–° LLVM/Clang 19 å…¨å®¶æ¡¶
############################################
RUN wget -qO- https://apt.llvm.org/llvm.sh | bash -s -- 19
RUN apt-get update && \
    apt-get install -y \
    clang-19 \
    lldb-19 \
    lld-19 \
    clangd-19 \
    libc++-19-dev \
    libc++abi-19-dev \
    && rm -rf /var/lib/apt/lists/*

############################################
# âš™ï¸ é…ç½®é»˜è®¤å¼€å‘ç¯å¢ƒ
############################################
RUN update-alternatives --install \
    /usr/bin/clang clang /usr/bin/clang-19 100 && \
    update-alternatives --install \
    /usr/bin/clang++ clang++ /usr/bin/clang++-19 100 && \
    update-alternatives --install \
    /usr/bin/lld lld /usr/bin/lld-19 100

# ğŸŒ å…¨å±€ç¯å¢ƒå˜é‡é…ç½®ï¼ˆå½±å“æ‰€æœ‰æ„å»ºç³»ç»Ÿï¼‰
# ğŸ¨ C ç¼–è¯‘å™¨æŒ‡å®š
ENV CC=/usr/bin/clang
# ğŸ¨ C++ ç¼–è¯‘å™¨æŒ‡å®š
ENV CXX=/usr/bin/clang++

# ğŸ“‚ åˆ›å»ºå·¥ä½œåŒºï¼ˆä½ çš„ä»£ç å°†å­˜æ”¾åœ¨è¿™é‡Œï¼‰
WORKDIR /workspace

# ğŸ§¼ æ·±åº¦æ¸…ç†ï¼ˆé•œåƒä½“ç§¯ä¼˜åŒ–å…³é”®æ­¥éª¤ï¼ï¼‰
RUN apt-get clean

# ğŸ–¥ï¸ é»˜è®¤å¯åŠ¨äº¤äº’å¼ç»ˆç«¯ï¼ˆè¿›å…¥å®¹å™¨å³å¯å¼€å§‹ç¼–ç ï¼‰
CMD ["/bin/bash"]
